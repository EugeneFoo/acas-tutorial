from . import basic, pdf
from govtech_csg_acas.securefileupload import logger

def sanitize(file, request):
    '''apply all sanitization'''
    logger.debug("[Sanitizer module] - Starting sanitization")

    # Perform basic file sanitization
    basic.sanitize_file(file, request)

    # Get guessed file type
    file_type = file.detection_results.guessed_mime

    # Perform file type specific sanitization
    if file_type == "application/pdf":
        pdf.sanitize_file(file)
    else:
        pass
