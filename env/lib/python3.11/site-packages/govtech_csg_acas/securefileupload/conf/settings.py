import os
from pathlib import Path

from django.conf import settings

from ..utils import fill_missing_configs

DEFAULT_UPLOAD_CONFIG = {
    "quicksand": True,
    "file_size_limit": None,
    "filename_length_limit": None,
    "whitelist_name": "RESTRICTIVE",
    "whitelist": [],
    "sanitization": True,
    "keep_original_filename": False,
    "clamav": False,
    "yara_file_location": os.path.join(Path(os.path.realpath(
        __file__)).parent.parent.absolute(), "vendor/yara")
}

GLOBAL_UPLOAD_CONFIG = getattr(settings, "ACAS_SECUREFILEUPLOAD_CONFIG", DEFAULT_UPLOAD_CONFIG)
GLOBAL_UPLOAD_CONFIG = fill_missing_configs(GLOBAL_UPLOAD_CONFIG, DEFAULT_UPLOAD_CONFIG)
